<script type="text/javascript">
  $(document).ready(function () {
    var prefixId = '<%= form.object_name.parameterize('_') %>',
        items = {
          send_email: ['smtp_provider_id', 'email_to', 'email_subject', 'email_body_template_id', 'email_body'],
          send_http_request: ['http_uri', 'http_method', 'http_params'],
          send_sms: ['sms_to', 'sms_body']
        };

    // Connect events to enable or disable the notification setting blocks.
    Object.keys(items).forEach(function ($ckBoxName) {
      var $ckBox = $('#{0}_{1}'.format(prefixId, $ckBoxName));

      $ckBox.on('change', function (e) {
        items[$ckBoxName].forEach(function (fieldName) {
          var $el = $('#{0}_{1}'.format(prefixId, fieldName)),
              $pa = $el.parents('.{0}_field'.format(fieldName.replace(/_id$/, ''))),
              checked = $(this).prop('checked');

          if ($(this).prop('checked') == false) {
            $el.prop('disabled', true);
            $pa.find('a.btn').hide();
          } else {
            $el.prop('disabled', false);
            $pa.find('a.btn').show();
          }
        }, this);
      });
      $ckBox.change();
    });

    // Connect events to select the email body type.
    var $eMailTemplate = $('#{0}_email_body_template_id'.format(prefixId));

    $eMailTemplate.on('change', function (e) {
      var $ckBox = $('#{0}_send_email'.format(prefixId)),
          $eMailBody = $('#{0}_email_body'.format(prefixId));

      if ($ckBox.prop('checked')) {
        if ($(this).prop('value') == '') {
          $eMailBody.prop('disabled', false);
          $eMailBody.parents('.email_body_field').show('slow');
        } else {
          $eMailBody.prop('disabled', true);
          $eMailBody.parents('.email_body_field').hide('slow');
        }
      }
    });
    $eMailTemplate.change();
  });
</script>